(()=>{plugin.onLoad(()=>{window.MAX_SEARCH_LIMIT=8;let l=!1;function d(){l||(l=!0)}window.addEventListener("hashchange",()=>{if(window.location.hash.startsWith("#/m/search")){let i="";window.location.hash.split("?")[1].split("&").forEach(t=>{t.startsWith("s=")&&(i=decodeURIComponent(t.split("=")[1]))}),window.cloudsearch(i).then(t=>{console.log(t),betterncm.utils.waitForElement(".m-plylist").then(n=>{let c=n.getElementsByTagName("ul")[0];for(let e=0;e<Math.min(8,t.total);e++){let a=t.list[e].id,s=document.createElement("li");s.className="itm f-cb j-item j-impress z-hascloud",s.setAttribute("data-log",JSON.stringify({events:["_ev"],isPage:!1,oid:"cell_pc_search_song",params:{s_calg:"",s_cid:a,s_ctraceid:"",s_ctrp:"",s_ctype:"song",s_position:1}})),s.setAttribute("data-res-id",a),s.setAttribute("data-res-menu","true"),s.setAttribute("data-res-type","4"),s.setAttribute("data-res-from","7"),s.setAttribute("data-res-bi-event","search")}})})}}),window.cloudsearch=function(i){return new Promise((t,n)=>{function c(a){console.log(a),t(a)}let e=window.ctl.cloudListManager.NI.uid;var o={data:{uid:e,offset:0,total:!0,limit:200,keyword:i},ext:{},key:`track_cloud_search-${e}-${i}`,limit:200,offset:0,onload:c,rkey:`r-track_cloud_search-${e}-${i}-0-200`};window.ctl.player.AJ[0].MF.$i(o),window.ctl.player.AJ[0].MF.Ge("doloadlist",o)})}});})();
